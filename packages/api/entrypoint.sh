#!/usr/bin/env sh

# http://redsymbol.net/articles/unofficial-bash-strict-mode/
set -euo pipefail

echo '
-------------------------------------------------------------------------------------------------------------------

 ██████╗███████╗███╗   ██╗████████╗██████╗  █████╗ ██╗   ██╗███████╗██████╗ ███████╗███████╗     █████╗ ██████╗ ██╗
██╔════╝██╔════╝████╗  ██║╚══██╔══╝██╔══██╗██╔══██╗██║   ██║██╔════╝██╔══██╗██╔════╝██╔════╝    ██╔══██╗██╔══██╗██║
██║     █████╗  ██╔██╗ ██║   ██║   ██████╔╝███████║██║   ██║█████╗  ██████╔╝███████╗█████╗      ███████║██████╔╝██║
██║     ██╔══╝  ██║╚██╗██║   ██║   ██╔══██╗██╔══██║╚██╗ ██╔╝██╔══╝  ██╔══██╗╚════██║██╔══╝      ██╔══██║██╔═══╝ ██║
╚██████╗███████╗██║ ╚████║   ██║   ██║  ██║██║  ██║ ╚████╔╝ ███████╗██║  ██║███████║███████╗    ██║  ██║██║     ██║
 ╚═════╝╚══════╝╚═╝  ╚═══╝   ╚═╝   ╚═╝  ╚═╝╚═╝  ╚═╝  ╚═══╝  ╚══════╝╚═╝  ╚═╝╚══════╝╚══════╝    ╚═╝  ╚═╝╚═╝     ╚═╝                                                                                                         

-------------------------------------------------------------------------------------------------------------------
'

echo 'Running migrations...'
yarn prisma generate
yarn prisma migrate deploy
echo 'Migrated!'


echo 'Starting centraverse api...'
yarn workspace @centraverse/api start
